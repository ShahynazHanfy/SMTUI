<div class="container">
	<h3 style="color: red;">Project Updates</h3>
	<!-- 
	<h1 class="headerw">{{project.projectName}}</h1>
	<button class="btn btn-warning AddButton" (click)="addNewUpdate()">Add Update</button>
	<a href="E:/PharmacyDictionary.docx">Show Latest Docs</a> -->

	<!-- <div *ngFor="let i of LstProjectUpdateDescription">
		<mat-card class="example-card">
			<mat-card-header>
				<mat-card-title>{{i.descriptionDate | slice:0:16}}</mat-card-title>
				<span>{{i.userName}}</span>
				<mat-card-subtitle>
					<br>
				</mat-card-subtitle>
			</mat-card-header>

			<mat-card-content>
				<p>
					{{i.description}}
				</p>
			</mat-card-content>

			<mat-card-actions>
				<button mat-button style="background-color:blue; color:white" (click)="ViewDocs(i)">
					Show Documents
				</button>

				<button mat-button style="background-color:green; color:white" (click)="MakeOfferFlag=true">
					Make an Offer
				</button>
			</mat-card-actions>
		</mat-card>
	</div> -->
	<p-dialog header=" Add Update " [(visible)]="NewLeaveDialogbool" [style]="{width: '50vw'}" [baseZIndex]="10000">
		<p-toast position="top-left" key="tl"></p-toast>
		<p-toast position="top-center" key="tc"></p-toast>
		<p-toast position="bottom-center" key="bc"></p-toast>
		<br>
		<div class="row container-fluid">
			<!-- <h2>{{project.projectName}}</h2> -->
			<div>
				<!-- <h4>Upload Documents</h4> -->
				<div class="row container">
					<div class="col-12">
						<div>
							<div class="p-inputgroup">
								<div class="form-group col-12" [style]="{minWidth: '420px'}" style="padding: 0 0 0 0;">
									<label for="inputState">Select Document Category</label>
									<select id="inputState" [ngModelOptions]="{standalone: true}"
										[(ngModel)]="docproject.documentsCategoryId" class="form-control">
										<option *ngFor="let i of lstDocumentCategory" value="{{i.id}}">
											{{i.categoryName}}</option>
									</select>
								</div>
							</div>
						</div>
						<div class="p-col-12">
							<div class="row">
								<div class="col">
									<input type="file" #file placeholder="Choose file" multiple
										(change)="uploadFile(file.files)" style="display:none;">
									<button type="button" class="btn btn-success" (click)="file.click()">Upload
										File</button>
								</div>
								<div class="col">
									<button class="btn btn-info" style="float: right;" (click)="Savedoctolist()">Save To
										List</button>
								</div>
							</div>
						</div>
					</div>

					<div style="margin-left: 10px;width: 100px;">
						<br>
						<table class="table container-fluid col-12" style="width: 100px">
							<thead>
								<tr>
									<th>Category Name</th>
									<th>File Name</th>
									<th>Delete</th>
								</tr>
							</thead>
							<tbody>

								<tr *ngFor="let i of lstoddocproj">
									<td>{{i.documentsCategoryName}}</td>
									<td>
										<div class="row">
											<div class="col">
												{{i.documentFile}}
											</div>

										</div>
									</td>
									<td>
										<div class="col"><button class="btn btn-danger"
												(click)="deleteDocFromList(i)">Delete</button></div>
									</td>

								</tr>

								<tr *ngIf="lstoddocproj.length == 0">
									<td colspan="4" style="color: rgb(102, 97, 23);">No Documents found.</td>
								</tr>

							</tbody>

						</table>
					</div>
				</div>
				<!-- <div style="margin-left: 10px;">
					<h4>Please Fill a detaild description </h4>
					<textarea id="description" [(ngModel)]="ProjectUpdateDescription.description"
						placeholder=" Description ......." pInputTextarea rows="10" cols="48"></textarea>
					<br>
				</div> -->
				<div class="input-group container-fluid uploadFile">
					<div class="input-group-prepend" style="background-color: rgb(215, 226, 226);">
						<span class="input-group-text"
							style="color: rgb(12, 12, 12);margin-right: 10px;">Description</span>
					</div>
					<textarea class="form-control" [(ngModel)]="ProjectUpdateDescription.description"
						aria-label="With textarea"></textarea>
				</div>
			</div>
		</div>
		<br>
		<ng-template pTemplate="footer">
			<p-button type="submit" (click)="SaveProjectUpdate()" icon="pi pi-check" label=""
				styleClass="p-button-text">
				<span>Save</span>
			</p-button>
			<p-button icon="pi pi-times" (click)="NewLeaveDialogbool=false" label="" class="p-button-secondary">NO
			</p-button>
		</ng-template>

	</p-dialog>
	<p-dialog header=" View Description " [(visible)]="ViewDocsUpadteFlag" [style]="{width: '60vw'}"
		[baseZIndex]="10000">
		<p-toast position="top-left" key="tl"></p-toast>
		<p-toast position="top-center" key="tc"></p-toast>
		<p-toast position="bottom-center" key="bc"></p-toast>
		<div class="row">
			<div class="row container">

				<div style="margin-left: 10px;">
					<br>
					<table class="table">
						<thead>
							<tr>
								<th>User Name</th>
								<th>Date</th>
								<th>Description</th>
							</tr>
						</thead>
						<tbody>

							<tr *ngFor="let i of LstProjectUpdateDescriptionByUpdateId">
								<td>
									{{i.userName}}
								</td>
								<td>
									{{i.descriptionDate | date: 'short'}}
								</td>
								<td>
									{{i.description}}
								</td>
							</tr>
							<tr *ngIf="LstProjectUpdateDescriptionByUpdateId.length == 0">
								<td colspan="4" style="color: rgb(102, 97, 23);">No Documents found.</td>
							</tr>
						</tbody>

					</table>
				</div>
			</div>
		</div>
		<!-- </div> -->
		<br>
		<ng-template pTemplate="footer">
			<p-button icon="pi pi-times" (click)="ViewDocsUpadteFlag=false" label="" class="p-button-secondary">Exit
			</p-button>
		</ng-template>

	</p-dialog>

	<p-dialog header=" View All Documents " [(visible)]="ViewDocsFlag" [style]="{width: '45vw'}" [baseZIndex]="10000">
		<p-toast position="top-left" key="tl"></p-toast>
		<p-toast position="top-center" key="tc"></p-toast>
		<p-toast position="bottom-center" key="bc"></p-toast>
		<!-- 
	<div class="row">
		<span class="col-md-3" for="employee">Employee Name</span>
		<select (change)="onChange($event.target.value)" name="employee" class="form-control col-md-6">Employee
			<option value="" selected disabled hidden><span>Employee Name</span></option>
			<option *ngFor="let item of GetUnregisteredUsers" value="{{item.id}}">{{item.name}}</option>
		</select>
	</div> -->
		<br>
		<div class="row">
			<!-- <h2>{{project.projectName}}</h2> -->
			<div style="margin-top: 30px;">
				<!-- <h4>Upload Documents</h4> -->
				<div class="row container">

					<div style="margin-left: 10px;">
						<br>
						<table class="table">
							<thead>
								<tr>
									<th>File Name</th>
									<th>Category Name</th>
									<th><i>View</i></th>
									<th><i>Delete</i></th>

								</tr>
							</thead>
							<tbody>

								<tr *ngFor="let i of lstProjDocuments">
									<td>
										{{i.documentFile}}
									</td>
									<td>
										{{i.documentsCategoryName}}
									</td>
									<td>
										<div class="col"><button class="btn btn-primary"
												(click)="viewSingleDoc(i)">View</button></div>
									</td>
									<td>
										<div class="col"><button class="btn btn-danger"
												(click)="deleteDocDB(i)">Delete</button></div>
									</td>

								</tr>

								<tr *ngIf="lstProjDocuments.length == 0">
									<td colspan="4" style="color: rgb(102, 97, 23);">No Documents found.</td>
								</tr>

							</tbody>

						</table>
					</div>
				</div>
			</div>
		</div>
		<!-- </div> -->
		<br>
		<ng-template pTemplate="footer">
			<p-button type="submit" (click)="SaveProjectUpdate()" icon="pi pi-check" label=""
				styleClass="p-button-text">
				<span>Save</span>
			</p-button>
			<p-button icon="pi pi-times" (click)="ViewDocsFlag=false" label="" class="p-button-secondary">NO
			</p-button>
		</ng-template>

	</p-dialog>

	<p-dialog header=" View Latest Documents " [(visible)]="ViewLatestDocsFlag" [style]="{width: '45vw'}"
		[baseZIndex]="10000">
		<p-toast position="top-left" key="tl"></p-toast>
		<p-toast position="top-center" key="tc"></p-toast>
		<p-toast position="bottom-center" key="bc"></p-toast>
		<br>
		<div class="row">
			<div style="margin-top: 30px;">
				<div class="row container">
					<div style="margin-left: 10px;">
						<br>
						<table class="table">
							<thead>
								<tr>
									<th>File Name</th>
									<th>Category Name</th>
									<th><i>View</i></th>
								</tr>
							</thead>
							<tbody>
								<tr *ngFor="let i of lstOfLatestProjDocuments">
									<td>
										{{i.documentFile}}
									</td>
									<td>
										{{i.documentsCategoryName}}
									</td>
									<td>
										<div class="col"><button class="btn btn-primary"
												(click)="viewSingleDoc(i)">View</button></div>
									</td>
								</tr>

								<tr *ngIf="lstOfLatestProjDocuments.length == 0">
									<td colspan="4" style="color: rgb(102, 97, 23);">No Documents found.</td>
								</tr>

							</tbody>

						</table>
					</div>
				</div>
			</div>
		</div>
		<br>
		<ng-template pTemplate="footer">

			<p-button icon="pi pi-times" (click)="ViewLatestDocsFlag=false" label="" class="p-button-secondary">Exit
			</p-button>
		</ng-template>

	</p-dialog>

	<p-dialog header=" Make Offer ({{project.projectName}})" [(visible)]="MakeOfferFlag" [style]="{width: '56vw'}">


		<p-toast position="top-left" key="tl"></p-toast>
		<p-toast position="top-center" key="tc"></p-toast>
		<p-toast position="bottom-center" key="bc"></p-toast>
		<img width="70px" height="70px" class="center"
			src="https://cdn.imgbin.com/16/4/6/imgbin-post-it-note-paper-clip-page-six-yellow-sticky-note-3uNPmBzME6aZAqRcZHvDqDQvk.jpg"
			alt="">
		<div class="row">
			<div class="row container">
				<div>
					<label for="inputState">Select OfferStatus</label>
					<div class="col">
						<p-dropdown [options]="LstOfferStatus" [(ngModel)]="offer.offerStatusId"
							[style]="{width: '14vw'}" placeholder="Offer Statues" optionLabel="offerStatusName"
							optionValue="id">
						</p-dropdown>
					</div>

				</div>
				<div class="col">
					<label for="inputState">Enter the cost
					</label>

					<p-inputNumber [showButtons]="true" [(ngModel)]="costObj.cost" buttonLayout="horizontal"
						inputId="horizontal" spinnerMode="horizontal" [step]="0.25"
						decrementButtonClass="p-button-danger" incrementButtonClass="p-button-success"
						incrementButtonIcon="pi pi-plus" decrementButtonIcon="pi pi-minus" mode="currency"
						currency={{value1}}>
					</p-inputNumber>

				</div>
				<div class="col">
					<label for="inputState">Currency</label>

					<p-selectButton [options]="stateOptions" (onChange)="catchCurrency($event)" #curr
						[(ngModel)]="value1" optionLabel="label" optionValue="value"></p-selectButton>

				</div>

			</div>
			<div class="row">
				<div class="col" style="margin-left: 15px;margin-top: 17px;">
					<div>
						<input type="file" #file2 placeholder="Choose file" multiple
							(change)="uploadFileInDataSheet(file2.files)" style="display:none;">
						<button type="button" class="btn btn-success" (click)="file2.click()">Upload
							File</button>
					</div>
					<div>
						<button class="btn btn-info" (click)="SavedocOffertolist()">Save To
							List</button>
					</div>
				</div>

				<div class="col">
					<br>
					<table class="table container">
						<thead>
							<tr>
								<th>File Name</th>
								<th>Delete</th>
							</tr>
						</thead>
						<tbody>

							<tr *ngFor="let i of lstdocOffer">
								<td>
									<div class="row">
										<div class="col">
											{{i.documentFile}}
										</div>

									</div>
								</td>
								<td>
									<div class="col"><button class="btn btn-danger"
											(click)="deleteDocOfferFromList(i)">Delete</button></div>
								</td>

							</tr>

							<tr *ngIf="lstdocOffer.length == 0">
								<td colspan="4" style="color: rgb(102, 97, 23);">No Documents found.</td>
							</tr>

						</tbody>

					</table>
				</div>
			</div>
			<div class="input-group container-fluid uploadFile">
				<div class="input-group-prepend">
					<span class="input-group-text">Description</span>
				</div>
				<textarea class="form-control" aria-label="With textarea"
					[(ngModel)]="offerDescription.description"></textarea>
			</div>
		</div>
		<ng-template pTemplate="footer">
			<!-- <p-button type="button" icon="pi pi-check" label="" (click)="SaveOffer()" styleClass="p-button-text">
				<span>Next</span>
			</p-button> -->

			<p-button type="submit" (click)="SaveOffer()" icon="pi pi-check" label="" styleClass="p-button-text">
				<span>Save</span>
			</p-button>
			<p-button icon="pi pi-times" (click)="MakeOfferFlag=false" label="" class="p-button-secondary">NO
			</p-button>
		</ng-template>

	</p-dialog>
</div>

<div class="card">
	<p-table #dt2 [value]="LstProjectUpdateDescription" dataKey="id" [rows]="5" [showCurrentPageReport]="true"
		[rowsPerPageOptions]="[5,10,50]" styleClass="p-datatable-customers container-fluid" [paginator]="true"
		currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
		[globalFilterFields]="['userName','descriptionDate']">
		<ng-template pTemplate="caption">
			<div class="p-d-flex">
				<span class="p-input-icon-left p-ml-auto">
					<i class="pi pi-search"></i>
					<input pInputText type="text" (input)="dt2.filterGlobal($event.target.value, 'contains')"
						placeholder="Search keyword" />

					<button class="btn btn-info" style="margin-left: 20px;" (click)="addNewUpdate()">Add
						New Update
					</button>
					<button class="btn btn-info" style="margin-left: 20px;"
						(click)="ViewLatestDocs(documentObj.projectId)">
						Show Latest Documents
					</button>
				</span>
			</div>
		</ng-template>
		<ng-template pTemplate="header">
			<tr>
				<th>User Name
					<p-columnFilter type="text" field="userName" display="menu"></p-columnFilter>
				</th>
				<th>Date
					<p-columnFilter type="date" field="descriptionDate" display="menu"></p-columnFilter>
				</th>
				<th>Show Description</th>
				<th>Show Documents</th>
				<th>Make Offer</th>
				<th>Offers</th>
			</tr>
			<!-- <tr>
				<th>Name
					<p-columnFilter type="text" field="userName" display="menu"></p-columnFilter>
				</th>
				<th>
					<div class="p-d-flex p-jc-between p-ai-center">
						Date
						<p-columnFilter type="date" field="descriptionDate" display="menu"></p-columnFilter>
					</div>
				</th>


			</tr> -->
		</ng-template>
		<ng-template pTemplate="body" let-customer>

			<tr>

				<td>
					<span style="font-weight: bold;">{{customer.userName}}</span>
				</td>
				<td>{{customer.descriptionDate | date: 'short'}}</td>
				<td>
					<button class="btn btn-primary" (click)="ViewDescrption(customer.id)">
						Description
					</button>
				</td>
				<td>
					<button class="btn btn-primary" (click)="ViewDocs(customer)">
						Documents
					</button>
				</td>
				<td>
					<button class="btn btn-primary" (click)="MakeOfferFlag=true">
						Make Offer
					</button>
				</td>
				<td>
					<button class="btn btn-primary" (click)="showOffers()">
						Offers
					</button>
				</td>
			</tr>
		</ng-template>
		<ng-template pTemplate="emptymessage">
			<tr>
				<td colspan="5">No customers found.</td>
			</tr>
		</ng-template>
	</p-table>
</div>



<p-dialog header=" View Offers " [(visible)]="ViewOffersFlag" [style]="{width: '60vw'}" [baseZIndex]="10000">

	<div class="card">
		<p-table #dt2 [value]="lstOffer" dataKey="id" [rows]="10" [showCurrentPageReport]="true"
			[rowsPerPageOptions]="[10,25,50]" styleClass="p-datatable-customers container-fluid" [paginator]="true"
			currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
			[globalFilterFields]="['projectName','OfferCreationDate','OfferStatusName','Cost']">
			<ng-template pTemplate="caption">
				<div class="p-d-flex">
					<span class="p-input-icon-left p-ml-auto">
						<i class="pi pi-search"></i>
						<input pInputText type="text" (input)="dt2.filterGlobal($event.target.value, 'contains')"
							placeholder="Search keyword" />
					</span>
				</div>
			</ng-template>
			<ng-template pTemplate="header">
				<tr>
					<th>Offer Name
						<p-columnFilter type="text" field="projectName" display="menu"></p-columnFilter>
					</th>
					<th>
						<div class="p-d-flex p-jc-between p-ai-center">
							Date
							<p-columnFilter type="date" field="offerCreationDate" display="menu"></p-columnFilter>
						</div>
					</th>
					<th>Cost
						<p-columnFilter type="text" field="cost" display="menu"></p-columnFilter>
					</th>
					<th>Status
						<p-columnFilter type="text" field="offerStatusName" display="menu"></p-columnFilter>
					</th>
				</tr>
			</ng-template>
			<ng-template pTemplate="body" let-customer>
				<tr>
					<td>
						<span style="font-weight: bold;">{{customer.projectName}}</span>
					</td>
					<td>{{customer.offerCreationDate | date: 'MM/dd/yyyy'}}</td>

					<td>
						{{customer.cost}}
					</td>

					<td>
						<p-dropdown [options]="LstOfferStatus" (onChange)="changeStatus(customer)" [readonly]="false"
							[(ngModel)]="customer.offerStatusId" optionLabel="offerStatusName" optionValue="id">
						</p-dropdown>
					</td>
				</tr>
			</ng-template>
			<ng-template pTemplate="emptymessage">
				<tr>
					<td colspan="5">No offers found.</td>
				</tr>
			</ng-template>
		</p-table>
	</div>
</p-dialog>